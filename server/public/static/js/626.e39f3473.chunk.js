"use strict";(self.webpackChunkfacebook_clone_app_react_client=self.webpackChunkfacebook_clone_app_react_client||[]).push([[626],{6414:function(e,t,n){n.d(t,{Z:function(){return B}});var a=n(2791),r=n(1876),l=n(9526),o=n(272),c=n(8489),i=n(3430),s=n(3174),u=n(4483),m=n(2734),p=n(7025);var d=function(e){var t=e.fileRef;return a.createElement(m.ZP,{title:"Select Image from Device",arrow:!0,placement:"bottom"},a.createElement(p.Z,{onClick:function(e){e.preventDefault(),t.current.click()}},a.createElement(u.G,{icon:s.VmB,color:"rgb(73,189,99)"})))},g=n(3713),f=n(8302),E=n(3837),y=n(4026),h=n(1606),b=n(1288),Z=n(269),x=n(6513),v=n(5720),S=n(6950),k=n(9576),w=n(6364);var P=function(e){var t=e.userState,n=e.body;return a.createElement(f.Z,null,a.createElement("b",null,t.currentUser.name),n.feelings?a.createElement(a.Fragment,null,"\xa0 is feeling ",a.createElement("b",null,n.feelings)):null,n.with.length?a.createElement(a.Fragment,null," with ",a.createElement("b",null,n.with.map((function(e){return a.createElement(a.Fragment,null," \xa0",(n=e,t.users.find((function(e){return e.id==n}))).name,",");var n})))):null,n.at?a.createElement(a.Fragment,null," at "," ",a.createElement("b",null,n.at," ")):null,n.date?a.createElement(a.Fragment,null,a.createElement("b",null,new Date(n.date).toLocaleDateString())):null)};var C=function(e){var t=e.userState,n=e.handleCloseDialog,r=e.body;return a.createElement("div",null,a.createElement(S.Z,{avatar:t.currentUser.profile_pic?a.createElement(o.Z,null,a.createElement("img",{style:{width:"100%",height:"100%"},src:t.currentUser.profile_pic})):a.createElement(w.Z,{text:t.currentUser.name,bg:"teal"}),title:a.createElement(a.Fragment,null,a.createElement(f.Z,{style:{fontWeight:"800",fontSize:"16px"}},t.currentUser.name)),action:a.createElement(p.Z,{onClick:function(){return n()}},a.createElement(k.Z,null))}),a.createElement(y.Z,null,a.createElement(l.Z,{style:{marginTop:"4px"},elevation:0},a.createElement(P,{userState:t,body:r}))))},D=n(6685);var _=function(e){var t=e.previewImage,n=e.removeFileImage;return a.createElement(a.Fragment,null,a.createElement(D.Z,{image:t,style:{width:"100",height:"220px"}}),a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:"8px",marginBottom:"8px"}},a.createElement(p.Z,{onClick:n,size:"medium"},a.createElement(o.Z,{style:{background:"tomato",color:"white"}},a.createElement(k.Z,null)))))},I=n(7166),T=n(3032),O=n(1044),z=n(9538),M=n(5032),U=function(e){var t=e.postData,n=e.body,l=e.isImageCaptured,o=e.postImage,s=e.blob,u=(0,z.k6)(),m=(0,a.useState)(!1),p=(0,i.Z)(m,2),d=p[0],g=p[1],f=(0,a.useContext)(r.QE).uiDispatch,E=(0,a.useContext)(r.W5).postDispatch,y=function(){var e=(0,T.Z)((0,I.Z)().mark((function e(t){var n,a;return(0,I.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),n=localStorage.token&&JSON.parse(localStorage.getItem("token")),e.prev=2,e.next=5,O.ZP.post("http://localhost:5000/api/post/",t,{headers:{Authorization:"Bearer ".concat(n)}});case 5:a=e.sent,g(!1),E({type:"ADD_POST",payload:a.data.post}),f({type:"SET_MESSAGE",payload:{color:"success",display:!0,text:a.data.message}}),f({type:"SET_POST_MODEL",payload:!1}),u.push("/"),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(2),g(!1),e.t0&&e.t0.response&&f({type:"SET_MESSAGE",payload:{display:!0,text:e.t0.response.data.error,color:"error"}}),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=(0,T.Z)((0,I.Z)().mark((function e(){var a,r=arguments;return(0,I.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.length>0&&void 0!==r[0]?r[0]:"",e.next=3,y((0,c.Z)((0,c.Z)({},t),{},{image:a||"",body:(0,c.Z)({},n)}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{handleSubmitPost:function(e){if(e.preventDefault(),l){var t="post/post-".concat(Date.now(),".png");M.t.ref("images/".concat(t)).put(s).on("state_changed",(function(){g(!0)}),(function(e){console.log("error from firebase"),g(!1),f({type:"SET_POST_MODEL",payload:!1})}),(function(){M.t.ref("images").child(t).getDownloadURL().then((function(e){h(e),g(!1)}))}))}else if(o){var n="post/post-".concat(Date.now(),"-").concat(o.name);M.t.ref("images/".concat(n)).put(o).on("state_changed",(function(){g(!0)}),(function(e){console.log("error from firebase"),g(!1),f({type:"SET_POST_MODEL",payload:!1})}),(function(){M.t.ref("images").child(n).getDownloadURL().then((function(e){h(e)}))}))}else h()},loading:d}},F=n(2130);function A(){var e=(0,a.useContext)(r.QE),t=e.uiState,n=e.uiDispatch,l=(0,a.useState)(null),s=(0,i.Z)(l,2),u=s[0],m=s[1],S=(0,a.useState)(null),w=(0,i.Z)(S,2),P=w[0],D=w[1],I=(0,a.useState)(""),T=(0,i.Z)(I,2),O=T[0],z=T[1],M=(0,a.useState)(!1),A=(0,i.Z)(M,2),B=A[0],L=A[1],R=(0,a.useState)({feelings:"",with:[],at:"",date:""}),W=(0,i.Z)(R,2),j=W[0],N=(W[1],(0,a.useState)({privacy:"Public",content:""})),G=(0,i.Z)(N,2),Q=G[0],K=G[1],J=(0,a.useContext)(r.St).userState,V=(0,a.useRef)();function q(){m(null),L(!1)}var H=U({postData:Q,body:j,postImage:P,isImageCaptured:B,blob:u}),X=H.handleSubmitPost,Y=H.loading;return a.createElement("div",null,a.createElement(f.Z,{style:{color:t.darkMode?null:"grey",padding:"8px",background:t.darkMode?null:"rgb(240,242,245)",borderRadius:"20px",cursor:"pointer"},onClick:function(){return n({type:"SET_POST_MODEL",payload:!0})}},"What`s in your mind, ",J.currentUser.name," ?"),Y?a.createElement(g.Z,{loading:Y,text:"Uploading Post..."}):a.createElement(E.Z,{disableBackdropClick:!0,disableEscapeKeyDown:!0,fullWidth:!0,scroll:"body",maxWidth:"sm",open:t.postModel,onClose:function(){return n({type:"SET_POST_MODEL",payload:!1})},style:{width:"100%"}},a.createElement(C,{userState:J,handleCloseDialog:function(){n({type:"SET_POST_MODEL",payload:!1})},body:j}),a.createElement(y.Z,null,a.createElement(h.Z,{placeholder:"Whats in your mind, ".concat(J.currentUser.name," ?"),multiline:!0,rows:3,value:Q.content,onChange:function(e){K((0,c.Z)((0,c.Z)({},Q),{},{content:e.target.value}))},style:{background:t.darkMode?null:"#fff",border:"none",width:"100%"}}),a.createElement(b.Z,{container:!0,justify:"center",style:{marginTop:"4px",marginBottom:"4px"}}),a.createElement(b.Z,{container:!0,alignItems:"center",justify:"center",style:{marginTop:"4px",marginBottom:"4px"}}),a.createElement(b.Z,{container:!0,alignItems:"center",justify:"center"},a.createElement(b.Z,{item:!0,xs:12,sm:6,md:6},a.createElement(d,{fileRef:V}))),a.createElement("span",null,"Add to your post"),O&&a.createElement(a.Fragment,null,a.createElement(F.Z,null,a.createElement("b",null,"Image Size (",Math.round(P.size/6024)," Kb)")),a.createElement(_,{previewImage:O,removeFileImage:function(){z(""),D(null)}})),function(){if(u){var e=URL.createObjectURL(u);return a.createElement(a.Fragment,null,a.createElement(F.Z,null,a.createElement("b",null,"Image Size (",Math.round(u.size/6024)," Kb)")),a.createElement("img",{src:e,style:{width:"100%",height:"100%"},alt:""}),a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:"8px",marginBottom:"8px"}},a.createElement(p.Z,{onClick:q,size:"medium"},a.createElement(o.Z,{style:{background:"tomato",color:"white"}},a.createElement(k.Z,null)))))}}()),a.createElement(Z.Z,null,a.createElement(x.Z,{disabled:Y,onClick:X,variant:"contained",color:"primary",style:{width:"100%"}},Y?a.createElement(v.Z,{variant:"indeterminate",size:25,style:{color:"#fff"}}):" Create Post"),a.createElement("input",{type:"file",style:{display:"none"},ref:V,onChange:function(e){D(e.target.files[0]);var t=new FileReader;t.readAsDataURL(e.target.files[0]),t.onload=function(){m(null),L(!1),z(t.result)}},accept:"image/*",capture:"user"}))))}var B=function(e){e.user;var t=(0,a.useContext)(r.St).userState,n=(0,a.useContext)(r.QE).uiState;return a.createElement("div",null,a.createElement(l.Z,{style:{maxWidth:"100%",padding:"16px",backgroundColor:n.darkMode&&"rgb(36,37,38)"}},a.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-start"}},t.currentUser.profile_pic?a.createElement(o.Z,null,a.createElement("img",{src:t.currentUser.profile_pic,width:"100%",height:"100%"})):a.createElement(w.Z,{text:t.currentUser.name,bg:t.currentUser.active?"seagreen":"tomato"}),a.createElement("div",{style:{width:"100%",marginLeft:"16px",marginRight:"16px"}},a.createElement(A,null)))))}},1787:function(e,t,n){var a=n(8302),r=n(2791);t.Z=function(e){var t=e.post;return r.createElement("div",null,r.createElement(a.Z,null,r.createElement("b",null,(t.body.feelings||t.body.with.length||t.body.at||t.body.date)&&t.user.name),t.body.feelings?r.createElement(r.Fragment,null,"\xa0 is feeling ",r.createElement("b",null,t.body.feelings)):null,t.body.with.length?r.createElement(r.Fragment,null," with ",r.createElement("b",null,t.body.with.map((function(e){return r.createElement("span",{key:e.id}," \xa0",e.name,",")})))):null,t.body.at?r.createElement(r.Fragment,null," at "," ",r.createElement("b",null,t.body.at," ")):null,t.body.date?r.createElement(r.Fragment,null,r.createElement("b",null,new Date(t.body.date).toLocaleDateString())):null))}},9948:function(e,t,n){n.d(t,{Z:function(){return I}});var a=n(8302),r=n(6513),l=n(2791),o=n(1876),c=n(9153),i=n(2426),s=n.n(i),u=n(283),m=n(6950),p=n(272),d=n(3364),g=n(8154),f=n(2953),E=n(6685),y=n(7447),h=n(1787);var b=function(e){var t=e.post,n=(0,l.useContext)(o.QE).uiState,r=(0,d.Z)(),c=(0,g.Z)(r.breakpoints.only("xs"));return l.createElement(l.Fragment,null,(t.body.feelings||t.body.with.length||t.body.at||t.body.date)&&l.createElement(f.Z,{style:{marginBottom:"16px",background:n.darkMode?"rgb(76,76,76)":"rgb(240,242,245)",padding:"16px"}},l.createElement(h.Z,{post:t})),l.createElement(f.Z,null,l.createElement(a.Z,{style:{fontWeight:"400",fontSize:"16px",fontFamily:"fantasy"}},t.content&&t.content)),t.image&&l.createElement(E.Z,{component:"img",style:{width:"100%",maxHeight:"500px",objectFit:"fill"},image:t.image,title:"Paella dish"}),Object.keys(t.profilePostData).length?l.createElement(l.Fragment,null,l.createElement(E.Z,{style:{width:"100%",height:"200px"},image:t.profilePostData.coverImage,title:t.user.name}),l.createElement(p.Z,{style:{border:"6px solid tomato",width:c?"300px":"400px",height:c?"300px":"400px",display:"flex",flexDirection:"row",margin:"auto",borderRadius:"100%",bottom:130}},l.createElement("img",{src:t.profilePostData.profileImage,width:"100%",height:"100%",alt:t.profilePostData.profileImage}))):null,l.createElement(y.Z,null))},Z=n(1523),x=n(1288),v=n(4483),S=n(1297),k=n(3174),w=n(6990);var P=function(e){var t=e.post,n=(0,l.useContext)(o.W5).postDispatch,a=(0,l.useContext)(o.QE).uiDispatch,c=(0,l.useContext)(o.St).userState,i=function(){return t.likes.includes(c.currentUser.id)};return l.createElement(l.Fragment,null,l.createElement(r.Z,{onClick:function(){(0,w.Qy)(t.id).then((function(e){e.data&&(n({type:"LIKE_UNLIKE_POST",payload:e.data.post}),a({type:"SET_MESSAGE",payload:{color:"success",text:e.data.message,display:!0}})),e.error&&a({type:"SET_MESSAGE",payload:{color:"error",text:e.data.error,display:!0}})})).catch((function(e){return console.log(e)}))},color:i()?"primary":"inherit",style:{width:"100%"},startIcon:i()?l.createElement(v.G,{icon:k.u8Q}):l.createElement(v.G,{icon:S.u8})},"(",t.likes.length,")"))};var C=function(e){var t=e.post,n=(0,l.useContext)(o.St).userState;(0,l.useEffect)((function(){c()}),[t.likes.length]);var c=function(){var e=n.currentUser.friends.filter((function(e){return t.likes.includes(e.id)}));return t.likes.includes(n.currentUser.id)&&e.push(n.currentUser),e.slice(0,4)};return l.createElement("div",{style:{margin:"8px 16px"}},l.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",marginBottom:"16px"}},l.createElement(v.G,{icon:S.u8,style:{padding:"4px",borderRadius:"100%",color:"#fff",background:"rgb(16,162,246)"},size:"lg"}),l.createElement(a.Z,{style:{marginLeft:"8px",color:"rgb(133,112,118)",fontSize:"12px"}},c().length?l.createElement(l.Fragment,null,c().map((function(e){return l.createElement("span",{key:e.id},e.name," ,")}))," ..."):null)),l.createElement(y.Z,null),l.createElement(x.Z,{container:!0,style:{padding:"4px 0px"}},l.createElement(x.Z,{item:!0,xs:6},l.createElement(P,{post:t})),l.createElement(x.Z,{item:!0,xs:6},l.createElement(r.Z,{style:{width:"100%"},startIcon:l.createElement(v.G,{icon:S.Mz}),component:Z.rU,to:"/post/".concat(t.id)},"Comments"))))},D=n(6364);var _=function(e){var t=e.post,n=(0,l.useContext)(o.QE).uiState;return l.createElement(u.Z,{style:{marginTop:"20px",backgroundColor:n.darkMode&&"rgb(36,37,38)"}},l.createElement(m.Z,{avatar:t.user&&t.user.profile_pic?l.createElement(p.Z,null,l.createElement("img",{alt:"",src:t.user.profile_pic,style:{width:"100%",height:"100%"}})):l.createElement(D.Z,{text:t.user.name,bg:t.user.active?"seagreen":"tomato"}),title:t&&l.createElement(a.Z,{style:{fontWeight:"800"}},t.user.name),subheader:t&&s()(t.createdAt).fromNow()}),l.createElement(b,{post:t}),l.createElement(C,{post:t}))};var I=function(e){var t=e.posts,n=(0,l.useContext)(o.W5).postState,i=(0,c.Z)().fetchPosts;return l.createElement("div",null,t.length?t.map((function(e){return l.createElement("div",{key:e.id},l.createElement(_,{post:e}))})):null,l.createElement("div",{style:{marginTop:"20px",display:"flex",justifyContent:"center"}},n.postPagination.totalPage<=n.postPagination.currentPage?l.createElement(a.Z,{style:{color:"teal"},variant:"body2"},"No more posts"):l.createElement(r.Z,{variant:"contained",color:"primary",onClick:function(){i()}},"More Posts")))}},3713:function(e,t,n){var a=n(3430),r=n(3837),l=n(9526),o=n(8302),c=n(4446),i=n(2791);t.Z=function(e){var t=e.loading,n=e.text,s=(0,i.useState)(t),u=(0,a.Z)(s,2),m=u[0],p=u[1];return i.createElement(r.Z,{disableBackdropClick:!0,disableEscapeKeyDown:!0,fullWidth:!0,scroll:"body",maxWidth:"sm",open:m,onClose:function(){return p(!1)},style:{width:"100%"}},i.createElement(l.Z,{style:{width:"100%",height:"100%",padding:"32px",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},elevation:15},i.createElement(o.Z,{style:{fontSize:"20px",fontWeight:"800",marginBottom:"16px"}},n),i.createElement(c.Z,{color:"secondary",style:{width:"50%"}})))}},5032:function(e,t,n){n.d(t,{t:function(){return r}});var a=n(1610);n(709);a.Z.initializeApp({apiKey:"AIzaSyCzvuA_6OGIIVRwbck71qBwNyRMXtBdSaE",authDomain:"bkuzu-295d0.firebaseapp.com",projectId:"bkuzu-295d0",storageBucket:"bkuzu-295d0.appspot.com",messagingSenderId:"305647920422",appId:"1:305647920422:web:b1366830f57614bf7e0de7"});var r=a.Z.storage()},9153:function(e,t,n){var a=n(7166),r=n(3032),l=n(3430),o=n(2791),c=n(1044),i=n(1876),s="http://localhost:5000";t.Z=function(){var e=(0,o.useState)(!1),t=(0,l.Z)(e,2),n=t[0],u=t[1],m=(0,o.useContext)(i.W5),p=m.postState,d=m.postDispatch,g=JSON.parse(localStorage.getItem("token")),f=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){var n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(p.post.commentPagination.currentPage>p.post.commentPagination.totalPage)){e.next=2;break}return e.abrupt("return");case 2:return u(!0),e.prev=3,e.next=6,c.ZP.get("".concat(s,"/api/post/").concat(t,"/comment/?page=").concat(p.post.commentPagination.currentPage),{headers:{Authorization:"Bearer ".concat(g)}});case 6:(n=e.sent).data&&d({type:"COMMENT_PAGINATION",payload:{currentPage:n.data.pagination.currentPage+1,totalPage:n.data.pagination.totalPage,comments:n.data.comments}}),u(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(3),u(!1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(){var t,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(p.postPagination.currentPage>p.postPagination.totalPage)){e.next=4;break}return e.abrupt("return");case 4:return u(!0),e.prev=5,e.next=8,c.ZP.get("".concat(s,"/api/post/?page=").concat(p.postPagination.currentPage),{headers:{Authorization:"Bearer ".concat(g)}});case 8:t=e.sent,(n=t.data)&&d({type:"POST_PAGINATION",payload:{currentPage:n.pagination.currentPage+1,totalPage:n.pagination.totalPage,posts:n.posts}}),u(!1),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(5),u(!1),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[5,14]])})));return function(){return e.apply(this,arguments)}}();return{fetchPosts:E,fetchComments:f,loading:n}}},6990:function(e,t,n){n.d(t,{Qy:function(){return c},UB:function(){return i}});var a=n(7166),r=n(3032),l=n(1044),o="http://localhost:5000",c=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){var n,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.parse(localStorage.token),e.prev=1,e.next=4,l.ZP.get("".concat(o,"/api/post/").concat(t,"/like_dislike"),{headers:{Authorization:"Bearer ".concat(n)}});case 4:if(!(r=e.sent).data){e.next=7;break}return e.abrupt("return",{data:r.data});case 7:e.next=14;break;case 9:if(e.prev=9,e.t0=e.catch(1),console.log(e.t0),!e.t0||!e.t0.response){e.next=14;break}return e.abrupt("return",{status:e.t0.response.status,error:e.t0.response.data.error});case 14:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=(0,r.Z)((0,a.Z)().mark((function e(t){var n,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=JSON.parse(localStorage.token),e.next=4,l.ZP.get("".concat(o,"/api/post/comment/").concat(t,"/like_dislike"),{headers:{Authorization:"Bearer ".concat(n)}});case 4:if(!(r=e.sent).data){e.next=7;break}return e.abrupt("return",{data:r.data});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=626.e39f3473.chunk.js.map